import{_ as n,C as r,c,o as i,a8 as s,b as o,j as A,w as E,a,G as d,a9 as l}from"./chunks/framework.DW4T_yAZ.js";const m=JSON.parse('{"title":"问卷管理页面","description":"","frontmatter":{},"headers":[],"relativePath":"projects/QuickSurvey-fe/Question-Management/Question-Management.md","filePath":"projects/QuickSurvey-fe/Question-Management/Question-Management.md","lastUpdated":1749448992000}'),B={name:"projects/QuickSurvey-fe/Question-Management/Question-Management.md"};function p(u,e,h,k,g,D){const t=r("Mermaid");return i(),c("div",null,[e[8]||(e[8]=s('<h1 id="问卷管理页面" tabindex="-1">问卷管理页面 <a class="header-anchor" href="#问卷管理页面" aria-label="Permalink to &quot;问卷管理页面&quot;">​</a></h1><h2 id="💡管理页面简介" tabindex="-1">💡<code>管理页面简介</code> <a class="header-anchor" href="#💡管理页面简介" aria-label="Permalink to &quot;💡`管理页面简介`&quot;">​</a></h2><blockquote><p>在问卷小筑系统中，<code>问卷管理</code>模块作为核心枢纽，全面负责问卷从<code>创建到归档</code>的全生命周期管理。它为用户提供简洁直观的操作界面，支持<code>快速创建</code>新问卷、高效浏览现有<code>问卷列表</code>，通过<code>星标</code>功能实现问卷的灵活分类与重点标注，更配备<code>回收站</code>机制，确保已删除问卷可追溯、可恢复，助力用户系统化、精细化地管理问卷资源 。</p></blockquote><h2 id="✉️架构概述" tabindex="-1">✉️<code>架构概述</code> <a class="header-anchor" href="#✉️架构概述" aria-label="Permalink to &quot;✉️`架构概述`&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">问卷管理页面由三个主要部分组成：</p><ol><li><strong>管理布局</strong> - 提供导航到不同管理部分的容器布局</li><li><strong>问卷卡片</strong> - 代表单个问卷并提供操作的组件</li><li><strong>问卷服务</strong> - 用于问卷 CRUD 操作的后端服务函数</li></ol></div>',5)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-33",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20A%5B%22%E7%AE%A1%E7%90%86%E5%B8%83%E5%B1%80%22%5D%20--%3E%20B%5B%22%E5%AF%BC%E8%88%AA%22%5D%0A%20%20%20%20A%20--%3E%20C%5B%22%E5%86%85%E5%AE%B9%E5%8C%BA%E5%9F%9F%20(Outlet)%22%5D%0A%0A%20%20%20%20B%20--%3E%20D%5B%22%E6%88%91%E7%9A%84%E9%97%AE%E5%8D%B7%22%5D%0A%20%20%20%20B%20--%3E%20E%5B%22%E6%98%9F%E6%A0%87%E9%97%AE%E5%8D%B7%22%5D%0A%20%20%20%20B%20--%3E%20F%5B%22%E5%9B%9E%E6%94%B6%E7%AB%99%22%5D%0A%0A%20%20%20%20C%20--%3E%20G%5B%22List.tsx%22%5D%0A%20%20%20%20C%20--%3E%20H%5B%22Star.tsx%22%5D%0A%20%20%20%20C%20--%3E%20I%5B%22Trash.tsx%22%5D%0A%0A%20%20%20%20G%20--%3E%20J%5B%22%E9%97%AE%E5%8D%B7%E5%8D%A1%E7%89%87%22%5D%0A%20%20%20%20H%20--%3E%20J%0A%20%20%20%20I%20--%3E%20K%5B%22%E8%A1%A8%E6%A0%BC%22%5D%0A%0A%20%20%20%20J%20--%3E%20L%5B%22%E7%BC%96%E8%BE%91%22%5D%0A%20%20%20%20J%20--%3E%20M%5B%22%E6%9F%A5%E7%9C%8B%E7%BB%9F%E8%AE%A1%22%5D%0A%20%20%20%20J%20--%3E%20N%5B%22%E6%98%9F%E6%A0%87%2F%E5%8F%96%E6%B6%88%E6%98%9F%E6%A0%87%22%5D%0A%20%20%20%20J%20--%3E%20O%5B%22%E5%A4%8D%E5%88%B6%22%5D%0A%20%20%20%20J%20--%3E%20P%5B%22%E5%88%A0%E9%99%A4%22%5D%0A%0A%20%20%20%20K%20--%3E%20Q%5B%22%E9%97%AE%E5%8D%B7%E6%9C%8D%E5%8A%A1%22%5D%0A%0A%20%20%20%20L%20--%3E%20R%5B%22%E9%97%AE%E5%8D%B7%E7%BC%96%E8%BE%91%E5%99%A8%22%5D%0A%20%20%20%20M%20--%3E%20S%5B%22%E7%BB%9F%E8%AE%A1%E9%A1%B5%E9%9D%A2%22%5D%0A%0A%20%20%20%20Q%20--%3E%20T%5B%22getQuestionListService%22%5D%0A%20%20%20%20Q%20--%3E%20U%5B%22createQuestionService%22%5D%0A%20%20%20%20Q%20--%3E%20V%5B%22updateQuestionService%22%5D%0A%20%20%20%20Q%20--%3E%20W%5B%22duplicateQuestionService%22%5D%0A%20%20%20%20Q%20--%3E%20X%5B%22deleteQuestionService%22%5D%0A"})]),fallback:E(()=>e[0]||(e[0]=[a(" Loading... ")])),_:1})),e[9]||(e[9]=s('<h2 id="🔑核心组件" tabindex="-1">🔑<code>核心组件</code> <a class="header-anchor" href="#🔑核心组件" aria-label="Permalink to &quot;🔑`核心组件`&quot;">​</a></h2><h3 id="管理布局" tabindex="-1"><code>管理布局</code> <a class="header-anchor" href="#管理布局" aria-label="Permalink to &quot;`管理布局`&quot;">​</a></h3><p><code>ManageLayout</code> 组件为问卷管理界面提供了<code>结构框架</code>，由<code>侧边栏导航</code>面板和渲染<code>子路由</code>的内容区域组成。</p><div class="info custom-block"><p class="custom-block-title">布局包括：</p><ul><li><strong>创建问卷按钮</strong>：创建一个新的空问卷并重定向到编辑器 <ul><li><strong>我的问卷</strong>：显示用户创建的所有问卷</li><li><strong>星标问卷</strong>：仅显示已标星的问卷</li><li><strong>回收站</strong>：显示已删除的问卷</li></ul></li></ul><p>内容区域使用 React Router 的 <code>Outlet</code> 组件来渲染<code>当前路由的组件</code>。</p></div><h3 id="问卷卡片" tabindex="-1"><code>问卷卡片</code> <a class="header-anchor" href="#问卷卡片" aria-label="Permalink to &quot;`问卷卡片`&quot;">​</a></h3><div class="info custom-block"><p class="custom-block-title"><code>QuestionCard</code> 组件是列表和星标视图中单个问卷的 UI 显示组件。它显示关键信息并提供操作按钮。</p><p><strong><code>问卷卡片显示</code></strong>：</p><ul><li>带有星标指示器的标题（如果已标星）</li><li>发布状态</li><li>回答数量</li><li>创建日期</li></ul><p><strong><code>并提供操作</code></strong>：</p><ul><li>编辑问卷</li><li>查看统计（如果未发布则禁用）</li><li>星标/取消星标</li><li>复制</li><li>删除（移至回收站）</li></ul></div><h3 id="问卷服务" tabindex="-1"><code>问卷服务</code> <a class="header-anchor" href="#问卷服务" aria-label="Permalink to &quot;`问卷服务`&quot;">​</a></h3><p>问卷服务提供了问卷管理操作的 <code>API</code>接口。</p><table tabindex="0"><thead><tr><th>服务函数</th><th>目的</th><th>参数</th><th>返回</th></tr></thead><tbody><tr><td><code>getQuestionService</code></td><td>获取单个问卷</td><td><code>id: string</code></td><td>问卷数据</td></tr><tr><td><code>creatQuestionService</code></td><td>创建新问卷</td><td>无</td><td>新问卷数据</td></tr><tr><td><code>getQuestionListService</code></td><td>获取问卷列表</td><td><code>ops: Partial&lt;SearchOps&gt;</code></td><td>列表和总数</td></tr><tr><td><code>updateQuestionService</code></td><td>更新问卷</td><td><code>id, ops: {[key: string]: any}</code></td><td>更新后的问卷</td></tr><tr><td><code>duplicateQuestionService</code></td><td>复制问卷</td><td><code>id</code></td><td>新问卷数据</td></tr><tr><td><code>deleteQuestionService</code></td><td>删除问卷</td><td><code>ids: string[]</code></td><td>删除结果</td></tr></tbody></table><h2 id="🛠️问卷操作" tabindex="-1">🛠️<code>问卷操作</code> <a class="header-anchor" href="#🛠️问卷操作" aria-label="Permalink to &quot;🛠️`问卷操作`&quot;">​</a></h2><h3 id="创建问卷" tabindex="-1"><code>创建问卷</code> <a class="header-anchor" href="#创建问卷" aria-label="Permalink to &quot;`创建问卷`&quot;">​</a></h3><p>问卷通过 <code>creatQuestionService</code> 函数创建，当用户点击 <code>ManageLayout</code> 组件中的&quot;创建问卷&quot;按钮时调用该函数。</p>',12)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-251",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20%E7%94%A8%E6%88%B7%0A%20%20%20%20participant%20ManageLayout%0A%20%20%20%20participant%20creatQuestionService%0A%20%20%20%20participant%20%E5%90%8E%E7%AB%AF%0A%0A%20%20%20%20%E7%94%A8%E6%88%B7-%3E%3EManageLayout%3A%20%E7%82%B9%E5%87%BB%22%E5%88%9B%E5%BB%BA%E9%97%AE%E5%8D%B7%22%0A%20%20%20%20ManageLayout-%3E%3EcreatQuestionService%3A%20%E8%B0%83%E7%94%A8%E6%9C%8D%E5%8A%A1%0A%20%20%20%20creatQuestionService-%3E%3E%E5%90%8E%E7%AB%AF%3A%20POST%20%2Fapi%2Fquestion%0A%20%20%20%20%E5%90%8E%E7%AB%AF-%3E%3EcreatQuestionService%3A%20%E8%BF%94%E5%9B%9E%E6%96%B0%E9%97%AE%E5%8D%B7%E6%95%B0%E6%8D%AE%0A%20%20%20%20creatQuestionService-%3E%3EManageLayout%3A%20%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%0A%20%20%20%20ManageLayout-%3E%3E%E7%94%A8%E6%88%B7%3A%20%E4%BD%BF%E7%94%A8%E6%96%B0ID%E5%AF%BC%E8%88%AA%E5%88%B0%E7%BC%96%E8%BE%91%E5%99%A8%0A"})]),fallback:E(()=>e[1]||(e[1]=[a(" Loading... ")])),_:1})),e[10]||(e[10]=A("h3",{id:"渲染问卷列表",tabindex:"-1"},[A("code",null,"渲染问卷列表"),a(),A("a",{class:"header-anchor",href:"#渲染问卷列表","aria-label":'Permalink to "`渲染问卷列表`"'},"​")],-1)),e[11]||(e[11]=A("p",null,[a("问卷使用 "),A("code",null,"getQuestionListService"),a(" 函数加载问卷列表，该函数支持按关键字、星标状态、删除状态和分页进行过滤。")],-1)),e[12]||(e[12]=A("p",null,[A("code",null,"List.tsx"),a(" 组件实现了无限滚动，随着用户向下"),A("code",null,"滚动加载更多"),a("问卷。")],-1)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-261",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20A%5B%22%E5%88%97%E8%A1%A8%E7%BB%84%E4%BB%B6%22%5D%20--%3E%20B%5B%22%E5%88%9D%E5%A7%8B%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%22%5D%0A%20%20%20%20B%20--%3E%20C%5B%22%E6%90%9C%E7%B4%A2%E5%8F%82%E6%95%B0%22%5D%0A%20%20%20%20B%20--%3E%20D%5B%22getQuestionListService()%22%5D%0A%20%20%20%20A%20--%3E%20I%5B%22%E6%BB%9A%E5%8A%A8%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC%E5%99%A8%22%5D%0A%0A%20%20%20%20C%20--%3E%20E%5B%22keyword%22%5D%0A%20%20%20%20C%20--%3E%20F%5B%22page%22%5D%0A%20%20%20%20C%20--%3E%20G%5B%22pageSize%22%5D%0A%0A%20%20%20%20D%20--%3E%20H%5B%22%E8%BF%BD%E5%8A%A0%E6%96%B0%E6%95%B0%E6%8D%AE%22%5D%0A%0A%0A%20%20%20%20H%20--%3E%20I%0A%0A%0A%20%20%20%20I%20--%3E%20J%7B%22%E5%8A%A0%E8%BD%BD%E6%9B%B4%E5%A4%9A%E5%8F%AF%E8%A7%81%3F%22%7D%0A%20%20%20%20J%20--%3E%7C%E6%98%AF%7C%20K%5B%22%E5%8A%A0%E8%BD%BD%E4%B8%8B%E4%B8%80%E9%A1%B5%22%5D%0A%20%20%20%20K%20--%3E%20D%0A%20%20%20%20K%20--%3E%20I%0A%0A%20%20%20%20J%20--%3E%7C%E5%90%A6%7C%20L%5B%22%E7%BB%93%E6%9D%9F%22%5D%0A"})]),fallback:E(()=>e[2]||(e[2]=[a(" Loading... ")])),_:1})),e[13]||(e[13]=s('<p>星标页面使用带有 <code>{ isStar: true }</code> 过滤条件的 <code>useLoadQuestionListData</code> 钩子来仅加载星标问卷。</p><h3 id="管理问卷" tabindex="-1"><code>管理问卷</code> <a class="header-anchor" href="#管理问卷" aria-label="Permalink to &quot;`管理问卷`&quot;">​</a></h3><p><code>QuestionCard</code> 组件提供了几个管理操作：</p><ol><li><strong>星标/取消星标</strong>：使用 <code>updateQuestionService</code> 切换星标状态</li><li><strong>复制</strong>：使用 <code>duplicateQuestionService</code> 创建副本</li><li><strong>删除</strong>：使用带有 <code>isDeleted: true</code> 的 <code>updateQuestionService</code> 移至回收站</li></ol>',4)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-288",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20%E7%94%A8%E6%88%B7%0A%20%20%20%20participant%20QuestionCard%0A%20%20%20%20participant%20QuestionServices%0A%20%20%20%20participant%20%E5%90%8E%E7%AB%AF%0A%0A%20%20%20%20%E7%94%A8%E6%88%B7-%3E%3EQuestionCard%3A%20%E7%82%B9%E5%87%BB%E6%93%8D%E4%BD%9C%E6%8C%89%E9%92%AE%0A%20%20%20%20alt%20%E6%98%9F%E6%A0%87%2F%E5%8F%96%E6%B6%88%E6%98%9F%E6%A0%87%0A%20%20%20%20%20%20%20%20QuestionCard-%3E%3EQuestionServices%3A%20updateQuestionService(id%2C%20%7BisStar%3A%20!current%7D)%0A%20%20%20%20else%20%E5%A4%8D%E5%88%B6%0A%20%20%20%20%20%20%20%20QuestionCard-%3E%3EQuestionServices%3A%20duplicateQuestionService(id)%0A%20%20%20%20else%20%E5%88%A0%E9%99%A4%0A%20%20%20%20%20%20%20%20QuestionCard-%3E%3EQuestionServices%3A%20updateQuestionService(id%2C%20%7BisDeleted%3A%20true%7D)%0A%20%20%20%20end%0A%20%20%20%20QuestionServices-%3E%3E%E5%90%8E%E7%AB%AF%3A%20API%E8%B0%83%E7%94%A8%0A%20%20%20%20%E5%90%8E%E7%AB%AF-%3E%3EQuestionServices%3A%20%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%0A%20%20%20%20QuestionServices-%3E%3EQuestionCard%3A%20%E6%9B%B4%E6%96%B0UI%0A%20%20%20%20QuestionCard-%3E%3E%E7%94%A8%E6%88%B7%3A%20%E6%98%BE%E7%A4%BA%E6%88%90%E5%8A%9F%E6%B6%88%E6%81%AF%0A"})]),fallback:E(()=>e[3]||(e[3]=[a(" Loading... ")])),_:1})),e[14]||(e[14]=s('<h2 id="⚙️管理界面" tabindex="-1">⚙️<code>管理界面</code> <a class="header-anchor" href="#⚙️管理界面" aria-label="Permalink to &quot;⚙️`管理界面`&quot;">​</a></h2><h3 id="我的问卷列表" tabindex="-1"><code>我的问卷列表</code> <a class="header-anchor" href="#我的问卷列表" aria-label="Permalink to &quot;`我的问卷列表`&quot;">​</a></h3><div class="info custom-block"><p class="custom-block-title">我的问卷界面显示用户创建的所有未删除问卷。它具有以下特点：</p><ul><li>滚动加载更多问卷</li><li>搜索功能</li><li>带有操作按钮的问卷卡片</li></ul><p>该组件使用<code>防抖</code>滚动<code>事件监听</code>器来检测何时加载更多数据：</p><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 无限滚动实现的伪代码</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tryLoadMore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (loadMoreElement 在视口中可见) {</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    加载下一页数据</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 添加带防抖的事件监听器</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contentRef.current.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;scroll&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, debouncedTryLoadMore)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div><h3 id="星标问卷" tabindex="-1"><code>星标问卷</code> <a class="header-anchor" href="#星标问卷" aria-label="Permalink to &quot;`星标问卷`&quot;">​</a></h3><p>星标问卷界面仅显示已标记为收藏的问卷。它使用与我的问卷列表相同的 <code>QuestionCard</code> 组件，但过滤条件为 <code>isStar: true</code>。</p><p>与我的问卷列表不同，星标问卷页面使用标准分页而不是无限滚动。</p><h3 id="回收站界面" tabindex="-1"><code>回收站界面</code> <a class="header-anchor" href="#回收站界面" aria-label="Permalink to &quot;`回收站界面`&quot;">​</a></h3><blockquote><p>回收站是问卷管理系统的重要组成部分，用于临时存储被<code>&quot;假删除&quot;</code>的问卷，使用户能够<code>恢复误删</code>的问卷或<code>彻底删除</code>不再需要的问卷。</p></blockquote><div class="info custom-block"><p class="custom-block-title">回收站界面由以下主要部分组成：</p><ol><li><strong>标题区域</strong> - 显示&quot;回收站&quot;标题和搜索功能</li><li><strong>操作按钮</strong> - 提供恢复和彻底删除选中问卷的功能</li><li><strong>表格视图</strong> - 以表格形式展示已删除的问卷及其详细信息</li><li><strong>分页组件</strong> - 允许用户浏览多页已删除的问卷</li></ol></div>',9)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-359",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99%E9%A1%B5%E9%9D%A2%20--%3E%20%E6%A0%87%E9%A2%98%E5%8C%BA%E5%9F%9F%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99%E9%A1%B5%E9%9D%A2%20--%3E%20%E8%A1%A8%E6%A0%BC%E5%8C%BA%E5%9F%9F%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99%E9%A1%B5%E9%9D%A2%20--%3E%20%E5%BA%95%E9%83%A8%2F%E5%88%86%E9%A1%B5%0A%0A%20%20%20%20%E6%A0%87%E9%A2%98%E5%8C%BA%E5%9F%9F%20--%3E%20A%5B%22%E6%A0%87%E9%A2%98('%E5%9B%9E%E6%94%B6%E7%AB%99')%22%5D%0A%20%20%20%20%E6%A0%87%E9%A2%98%E5%8C%BA%E5%9F%9F%20--%3E%20%E6%90%9C%E7%B4%A2%E7%BB%84%E4%BB%B6%0A%0A%20%20%20%20%E8%A1%A8%E6%A0%BC%E5%8C%BA%E5%9F%9F%20--%3E%20%E6%93%8D%E4%BD%9C%E6%8C%89%E9%92%AE%0A%20%20%20%20%E8%A1%A8%E6%A0%BC%E5%8C%BA%E5%9F%9F%20--%3E%20%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%A0%BC%0A%0A%20%20%20%20%E6%93%8D%E4%BD%9C%E6%8C%89%E9%92%AE%20--%3E%20%E6%81%A2%E5%A4%8D%E6%8C%89%E9%92%AE%0A%20%20%20%20%E6%93%8D%E4%BD%9C%E6%8C%89%E9%92%AE%20--%3E%20%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4%E6%8C%89%E9%92%AE%0A%0A%20%20%20%20%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%A0%BC%20--%3E%20%E8%A1%A8%E6%A0%BC%E5%88%97%0A%0A%20%20%20%20%E8%A1%A8%E6%A0%BC%E5%88%97%20--%3E%20B%5B%22%E6%A0%87%E9%A2%98%22%5D%0A%20%20%20%20%E8%A1%A8%E6%A0%BC%E5%88%97%20--%3E%20%E5%8F%91%E5%B8%83%E7%8A%B6%E6%80%81%0A%20%20%20%20%E8%A1%A8%E6%A0%BC%E5%88%97%20--%3E%20%E6%98%9F%E6%A0%87%E7%8A%B6%E6%80%81%0A%20%20%20%20%E8%A1%A8%E6%A0%BC%E5%88%97%20--%3E%20%E7%AD%94%E5%8D%B7%E6%95%B0%E9%87%8F%0A%20%20%20%20%E8%A1%A8%E6%A0%BC%E5%88%97%20--%3E%20%E5%88%9B%E5%BB%BA%E6%97%B6%E9%97%B4%0A%0A%20%20%20%20%E5%BA%95%E9%83%A8%2F%E5%88%86%E9%A1%B5%20--%3E%20ListPage%E7%BB%84%E4%BB%B6%0A"})]),fallback:E(()=>e[4]||(e[4]=[a(" Loading... ")])),_:1})),e[15]||(e[15]=s('<h4 id="数据加载" tabindex="-1"><code>数据加载</code> <a class="header-anchor" href="#数据加载" aria-label="Permalink to &quot;`数据加载`&quot;">​</a></h4><p>回收站使用 <code>useLoadQuestionListData</code> 钩子加载已删除的问卷列表，通过传递 <code>{ isDeleted: true }</code> 参数来筛选出已删除的问卷。这个钩子会从后端获取数据，并在搜索参数变化时自动刷新。</p><h4 id="核心操作" tabindex="-1"><code>核心操作</code> <a class="header-anchor" href="#核心操作" aria-label="Permalink to &quot;`核心操作`&quot;">​</a></h4><div class="info custom-block"><p class="custom-block-title">回收站提供两个主要操作：</p><ol><li><strong>恢复问卷</strong> - 将问卷从回收站移回到主列表</li><li><strong>彻底删除问卷</strong> - 从系统中永久删除问卷</li></ol><h5 id="恢复问卷" tabindex="-1"><code>恢复问卷</code> <a class="header-anchor" href="#恢复问卷" aria-label="Permalink to &quot;`恢复问卷`&quot;">​</a></h5><p>恢复操作通过将问卷的 <code>isDeleted</code> 属性从 <code>true</code> 更改为 <code>false</code> 来实现，这样问卷就会重新出现在主问卷列表中</p><p>当用户选择一个或多个问卷并点击&quot;恢复&quot;按钮时，系统会为每个选中的问卷调用 <code>updateQuestionService</code> 服务，将其 <code>isDeleted</code> 属性设置为 <code>false</code>。</p><h5 id="彻底删除问卷" tabindex="-1"><code>彻底删除问卷</code> <a class="header-anchor" href="#彻底删除问卷" aria-label="Permalink to &quot;`彻底删除问卷`&quot;">​</a></h5><p>彻底删除操作会永久移除问卷，这与将问卷移至回收站的软删除不同，此操作不可逆。当用户选择问卷并点击&quot;彻底删除&quot;按钮时，系统会显示确认对话框。如果用户确认，系统会调用 <code>deleteQuestionService</code> 服务，传入所有选中问卷的 ID 数组实现问卷<code>彻底删除</code>。</p></div>',4)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-398",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20%E7%94%A8%E6%88%B7%0A%20%20%20%20participant%20%E5%9B%9E%E6%94%B6%E7%AB%99%0A%20%20%20%20participant%20%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%0A%20%20%20%20participant%20%E5%90%8E%E7%AB%AFAPI%0A%0A%20%20%20%20%E7%94%A8%E6%88%B7-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E9%80%89%E6%8B%A9%E8%B0%83%E6%9F%A5%E9%97%AE%E5%8D%B7%0A%20%20%20%20%E7%94%A8%E6%88%B7-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E7%82%B9%E5%87%BB%E2%80%9C%E6%81%A2%E5%A4%8D%E2%80%9D%E6%8C%89%E9%92%AE%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99-%3E%3E%E5%90%8E%E7%AB%AFAPI%3A%20%E8%B0%83%E7%94%A8%20updateQuestionService%0A%20%20%20%20%E5%90%8E%E7%AB%AFAPI-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E8%BF%94%E5%9B%9E%E6%88%90%E5%8A%9F%E5%93%8D%E5%BA%94%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99-%3E%3E%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%3A%20%E5%88%B7%E6%96%B0%E8%B0%83%E6%9F%A5%E8%A1%A8%E5%88%97%E8%A1%A8%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99-%3E%3E%E7%94%A8%E6%88%B7%3A%20%E6%98%BE%E7%A4%BA%E6%88%90%E5%8A%9F%E6%B6%88%E6%81%AF%0A%0A%20%20%20%20%E7%94%A8%E6%88%B7-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E9%80%89%E6%8B%A9%E8%B0%83%E6%9F%A5%E9%97%AE%E5%8D%B7%0A%20%20%20%20%E7%94%A8%E6%88%B7-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E7%82%B9%E5%87%BB%E2%80%9CDelete%E2%80%9D%E6%8C%89%E9%92%AE%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E6%98%BE%E7%A4%BA%E7%A1%AE%E8%AE%A4%E5%AF%B9%E8%AF%9D%E6%A1%86%0A%20%20%20%20%E7%94%A8%E6%88%B7-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E7%A1%AE%E8%AE%A4%E5%88%A0%E9%99%A4%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99-%3E%3E%E5%90%8E%E7%AB%AFAPI%3A%20%E8%B0%83%E7%94%A8%20deleteQuestionService%0A%20%20%20%20%E5%90%8E%E7%AB%AFAPI-%3E%3E%E5%9B%9E%E6%94%B6%E7%AB%99%3A%20%E8%BF%94%E5%9B%9E%E6%88%90%E5%8A%9F%E5%93%8D%E5%BA%94%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99-%3E%3E%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%3A%20%E5%88%B7%E6%96%B0%E8%B0%83%E6%9F%A5%E8%A1%A8%E5%88%97%E8%A1%A8%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99-%3E%3E%E7%94%A8%E6%88%B7%3A%20%E6%98%BE%E7%A4%BA%E6%88%90%E5%8A%9F%E6%B6%88%E6%81%AF%0A"})]),fallback:E(()=>e[5]||(e[5]=[a(" Loading... ")])),_:1})),e[16]||(e[16]=s('<h4 id="用户界面实现" tabindex="-1"><code>用户界面实现</code> <a class="header-anchor" href="#用户界面实现" aria-label="Permalink to &quot;`用户界面实现`&quot;">​</a></h4><div class="info custom-block"><p class="custom-block-title">回收站的用户界面使用 Ant Design 组件构建：</p><h5 id="表格显示" tabindex="-1"><code>表格显示</code> <a class="header-anchor" href="#表格显示" aria-label="Permalink to &quot;`表格显示`&quot;">​</a></h5><p>表格组件显示问卷数据，包含以下列：</p><ul><li>问卷标题</li><li>发布状态</li><li>星标状态</li><li>答卷数量</li><li>创建时间</li></ul><p>每行可以通过复选框选择，用于批量操作。</p><h5 id="操作按钮" tabindex="-1"><code>操作按钮</code> <a class="header-anchor" href="#操作按钮" aria-label="Permalink to &quot;`操作按钮`&quot;">​</a></h5><p>回收站界面提供两个主要操作按钮：</p><ol><li><strong>恢复按钮</strong> - 仅当至少选择了一个问卷时启用</li><li><strong>彻底删除按钮</strong> - 仅当至少选择了一个问卷时启用</li></ol><p>对于彻底删除操作，系统会显示确认对话框以防止意外删除。</p></div><h4 id="与其他系统组件的集成" tabindex="-1"><code>与其他系统组件的集成</code> <a class="header-anchor" href="#与其他系统组件的集成" aria-label="Permalink to &quot;`与其他系统组件的集成`&quot;">​</a></h4><p>回收站是问卷生命周期管理的<code>重要部分</code>：</p>',4)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-467",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20%E4%B8%BB%E9%97%AE%E5%8D%B7%E5%88%97%E8%A1%A8%20--%3E%7C%E5%88%A0%E9%99%A4%E9%97%AE%E5%8D%B7%7C%20%E5%9B%9E%E6%94%B6%E7%AB%99%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99%20--%3E%7C%E6%81%A2%E5%A4%8D%7C%20%E4%B8%BB%E9%97%AE%E5%8D%B7%E5%88%97%E8%A1%A8%0A%20%20%20%20%E6%98%9F%E6%A0%87%E9%97%AE%E5%8D%B7%20--%3E%7C%E5%88%A0%E9%99%A4%E9%97%AE%E5%8D%B7%7C%20%E5%9B%9E%E6%94%B6%E7%AB%99%0A%20%20%20%20%E5%9B%9E%E6%94%B6%E7%AB%99%20--%3E%7C%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4%7C%20%E4%BB%8E%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%A7%BB%E9%99%A4%0A%0A"})]),fallback:E(()=>e[6]||(e[6]=[a(" Loading... ")])),_:1})),e[17]||(e[17]=s('<p>回收站在问卷生命周期中充当中间步骤，在永久删除前提供<code>安全网</code>。</p><h4 id="技术实现细节" tabindex="-1"><code>技术实现细节</code> <a class="header-anchor" href="#技术实现细节" aria-label="Permalink to &quot;`技术实现细节`&quot;">​</a></h4><div class="tip custom-block"><p class="custom-block-title">TIP</p><h5 id="api-交互" tabindex="-1"><code>API 交互</code> <a class="header-anchor" href="#api-交互" aria-label="Permalink to &quot;`API 交互`&quot;">​</a></h5><p>回收站通过三个主要服务函数与后端 API 交互：</p><ol><li><code>getQuestionListService</code> - 获取已删除问卷列表</li><li><code>updateQuestionService</code> - 更新问卷的 <code>isDeleted</code> 属性以恢复问卷</li><li><code>deleteQuestionService</code> - 永久删除问卷</li></ol><h5 id="数据加载钩子" tabindex="-1"><code>数据加载钩子</code> <a class="header-anchor" href="#数据加载钩子" aria-label="Permalink to &quot;`数据加载钩子`&quot;">​</a></h5><p>自定义钩子 <code>useLoadQuestionListData</code> 用于加载和刷新已删除问卷列表。它接收一个选项对象，指定过滤条件如 <code>isDeleted: true</code> 以仅获取回收站中的项目。</p><h5 id="选择机制" tabindex="-1"><code>选择机制</code> <a class="header-anchor" href="#选择机制" aria-label="Permalink to &quot;`选择机制`&quot;">​</a></h5><p>回收站系统使用状态变量 <code>selectedIds</code> 跟踪表格中选择的问卷。这个选择用于批量操作，如恢复和删除。</p><h4 id="性能考虑" tabindex="-1"><code>性能考虑</code> <a class="header-anchor" href="#性能考虑" aria-label="Permalink to &quot;`性能考虑`&quot;">​</a></h4><p>回收站系统实现了几项优化：</p><ol><li><strong>防抖请求</strong> - 使用 <code>debounceWait: 500</code> 防止快速连续的 API 调用</li><li><strong>手动触发</strong> - API 请求手动触发（<code>manual: true</code>）而不是自动触发</li><li><strong>选择性渲染</strong> - 根据加载状态和数据可用性渲染不同的 UI 元素</li></ol></div><h2 id="♻️数据流" tabindex="-1">♻️<code>数据流</code> <a class="header-anchor" href="#♻️数据流" aria-label="Permalink to &quot;♻️`数据流`&quot;">​</a></h2><p>问卷管理系统遵循以下数据流模式：</p>',5)),(i(),o(l,null,{default:E(()=>[d(t,{id:"mermaid-540",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20subgraph%20%22UI%E7%BB%84%E4%BB%B6%22%0A%20%20%20%20%20%20%20%20ManageLayout%20--%3E%20List%2FStar%2FTrash%E9%A1%B5%E9%9D%A2%0A%20%20%20%20%20%20%20%20List%2FStar%2FTrash%E9%A1%B5%E9%9D%A2%20--%3E%20QuestionCard%0A%20%20%20%20end%0A%20%20%20%20subgraph%20%22React%E9%92%A9%E5%AD%90%22%0A%20%20%20%20%20%20%20%20QuestionCard%20--%3E%20A%5B%22useRequest(ahooks)%22%5D%0A%20%20%20%20%20%20%20%20List%2FStar%2FTrash%E9%A1%B5%E9%9D%A2%20--%3E%20useLoadQuestionListData%0A%20%20%20%20end%0A%20%20%20%20subgraph%20%22%E6%9C%8D%E5%8A%A1%22%0A%20%20%20%20%20%20%20%20A%20--%3E%20createQuestionService%0A%20%20%20%20%20%20%20%20A%20--%3E%20updateQuestionService%0A%20%20%20%20%20%20%20%20A%20--%3E%20duplicateQuestionService%0A%20%20%20%20%20%20%20%20A%20--%3E%20deleteQuestionService%0A%20%20%20%20%20%20%20%20useLoadQuestionListData%20--%3E%20getQuestionListService%0A%20%20%20%20end%0A%0A"})]),fallback:E(()=>e[7]||(e[7]=[a(" Loading... ")])),_:1})),e[18]||(e[18]=s('<h2 id="✏️技术实现" tabindex="-1">✏️<code>技术实现</code> <a class="header-anchor" href="#✏️技术实现" aria-label="Permalink to &quot;✏️`技术实现`&quot;">​</a></h2><h3 id="搜索功能" tabindex="-1"><code>搜索功能</code> <a class="header-anchor" href="#搜索功能" aria-label="Permalink to &quot;`搜索功能`&quot;">​</a></h3><div class="tip custom-block"><p class="custom-block-title">搜索功能使用 URL 搜索参数实现。搜索关键字存储在 URL 中，这允许：</p><ul><li>收藏搜索结果</li><li>分享搜索结果</li><li>浏览器历史导航</li></ul><p>组件使用 React Router 的 <code>useSearchParams</code> 钩子检索搜索参数：</p><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">searchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> keyword</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> searchParams.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LIST_SEARCH_PARAMS_KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div>',3))])}const C=n(B,[["render",p]]);export{m as __pageData,C as default};
